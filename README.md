# python_web_hw8_RabbitMQ

Домашнее задание #8

Вторая часть

Напишите два скрипта: consumer.py и producer.py. Используя RabbitMQ организуйте с помощью очередей имитацию рассылки email контактам.

docker run -d --name rabbitmq -p 5672:5672 -p 15672:15672 rabbitmq:3.11-management

Используя ODM Mongoengine создайте модель для контакта. Модель обязательно должна включать поля: полное имя, email и логическое поле, которое имеет значение False, по умолчанию. Оно означает, что сообщение контакту не отправлено и должно стать True, когда будет отправлено. Остальные поля для информационной нагрузки можете придумать сами.

При запуске скрипта producer.py он генерирует определенное количество фейковых контактов и записывает их в базу данных. Потом помещает в очередь RabbitMQ сообщение, которое содержит ObjectID созданного контакта, и так для всех сгенерированных контактов.

Скрипт consumer.py получает из очереди RabbitMQ сообщение, обрабатывает его и имитирует функцией-заглушкой отправку сообщения по email. После отправки сообщения, необходимо логическое поле для контакта установить в True. Скрипт работает постоянно в ожидании поступающих сообщений из RabbitMQ.

WIKI
Функция-заглушка (англ. stub function) - функция, не выполняющая никакого осмысленного действия, возвращающая пустой результат или входные данные в неизменном виде. То же самое, что заглушка метода.

Заглушка может имитировать поведение существующего кода (например, процедуры на удаленном компьютере) или быть временной заменой еще не созданного кода. Например, вместо функции, выполняющей сложные вычисления, можно временно (пока не будет написана сама функция) поставить возвращающую всегда заглушку 1 и отлаживать другие функции, зависящие от нее.

Дополнительное задание

Заведите в модели дополнительное поле телефонный номер. Также добавте поле отвечающее за предпочтительный способ отправки сообщений — SMS по телефону или email. Пусть producer.py отправляет в разные очереди контакты для SMS и email. Создайте два скрипта consumer_sms.py и consumer_email.py, каждый из которых получает свои контакты и обрабатывает их.